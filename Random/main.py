from random import randrange
from datetime import timedelta
from datetime import datetime
import random
from collections import defaultdict


def printMatrix(mat):
    i = 0
    for row in mat:
        print(i+1, row)
        i += 1

def random_date(start, end, count):
    output = []
    for d in range(count):
        delta = end - start
        int_delta = (delta.days * 24 * 60 * 60) + delta.seconds
        random_second = randrange(int_delta)
        output.append(start + timedelta(seconds=random_second))
    return output

def createDummyData(dates, total_sites):
    hashmap = defaultdict(set)
    for date in dates:
        hashmap[date.day].add(random.randint(1, total_sites))
    return hashmap

def createMatrix(avail_sites, total_sites):
    total_days = 31
    matrix = [['F' for i in range(total_sites)] for j in range(total_days)]
    for day, site in avail_sites.items():
        for s in site:
            matrix[int(day)-1][s-1] = 'T'
    return matrix

def getNumbers(cols):
    res = [None] * len(cols)
    i = 0
    while i < len(cols):
        if cols[i] == 'F':
            res[i] = 0
            i += 1
        else:
            count = 0
            j = i
            while j < len(cols) and cols[j] == 'T':
                count += 1
                j += 1
            res[i] = count
            i += 1
    return res

def findDates(mat, date, days):
    if date > 31 or date <= 0:
        raise AttributeError('Not Valid Date')
    output = [[0 for i in range(len(mat[0]))] for j in range(len(mat))]
    query = output[date-1]
    avalaible_sites = []

    for i in range(len(mat[0])):
        col = []
        for j in range(len(mat)):
            col.append(mat[j][i])
        new_col = getNumbers(col)
        for k in range(len(new_col)):
            output[k][i] = new_col[k]
#     printMatrix(output)
    for d in range(len(query)):
        if query[d] >= days:
            avalaible_sites.append(d+1)
    return avalaible_sites


new_mapped_dict = defaultdict(list)
months_avail = defaultdict(dict)
months_mapped_dict = defaultdict(dict)
all_sites = {}
count = 1


new_data = {'2020-05-25': ['E004', 'E002', 'E003'], '2020-08-02': ['F011', 'B021', 'F003', 'A024', 'C019', 'F001', 'C011', 'F010', 'B038', 'D002', 'F015', 'D026', 'E007', 'D017', 'A023', 'D010', 'C008', 'C012', 'F002', 'F005', 'F013', 'D006', 'C023', 'D018', 'C020', 'D035', 'F016', 'F008', 'A015R', 'F017', 'D001', 'D004', 'F007', 'F009', 'C009', 'F012', 'F014', 'C017', 'B020', 'D009', 'D029', 'D003', 'B013', 'B022', 'C005', 'D005', 'B015', 'C027', 'C021', 'D039', 'D012', 'C014', 'C018', 'A009R', 'F006', 'F004', 'C015', 'F018'], '2020-05-21': ['E004'], '2020-06-29': ['E004', 'F004'], '2020-03-04': ['F011', 'C004', 'D028', 'C006', 'D038', 'C007', 'D030', 'C019', 'F001', 'C011', 'D032', 'F010', 'B038', 'D002', 'F015', 'D026', 'E007', 'D017', 'B019', 'A022', 'B018b', 'D010', 'B031', 'B005', 'C012', 'F002', 'A019', 'D034', 'D015', 'B032', 'D018', 'E004', 'B057', 'F008', 'B018c', 'F017', 'E002', 'B023', 'D013', 'D001', 'B029', 'D004', 'F007', 'F009', 'B011', 'C009', 'B007', 'A028', 'B008', 'E001', 'E005', 'C028', 'B018a', 'B061', 'E003', 'D009', 'D029', 'B053a', 'D008', 'D011', 'B009', 'C013', 'D003', 'B033', 'C025', 'B013', 'B045', 'D005', 'C002', 'D031', 'C027', 'C021', 'A004', 'C024', 'B053c', 'B053b', 'C018', 'F006', 'B037', 'F018'], '2020-03-08': ['B023', 'B026', 'B047'], '2020-04-13': ['E003'], '2020-04-19': ['E007', 'E004', 'E002', 'E003'], '2020-05-04': ['E007', 'E002', 'B029'], '2020-07-10': ['F011', 'F014'], '2020-04-08': ['E003'], '2020-05-19': ['E001'], '2020-06-10': ['E004', 'E001'], '2020-03-23': ['E007', 'E001'], '2020-04-15': ['E007', 'E004', 'D003'], '2020-04-12': ['E005', 'E003'], '2020-04-22': ['E007', 'D015', 'E002', 'F009', 'E005', 'E003', 'D009'], '2020-08-12': ['D037', 'B039', 'F011', 'C004', 'B021', 'D028', 'C006', 'D022', 'F003', 'D038', 'D030', 'F001', 'C011', 'D032', 'F010', 'B038', 'D002', 'F015', 'D026', 'E007', 'A005R', 'A006', 'A023', 'A003', 'A022', 'B017', 'D010', 'C010', 'C008', 'C012', 'F005', 'F013', 'D006', 'C023', 'D034', 'D015', 'B032', 'D018', 'D027', 'C020', 'D035', 'D036', 'B004', 'F016', 'A008', 'F008', 'A030', 'F017', 'B001', 'E002', 'D013', 'D004', 'F007', 'F009', 'D014', 'C009', 'F014', 'B059', 'B034', 'C017', 'A028', 'E001', 'C028', 'B027', 'E003', 'D009', 'D029', 'D008', 'D011', 'B009', 'C013', 'C003', 'D003', 'B043', 'B013', 'B022', 'D005', 'C002', 'A002', 'D031', 'C027', 'C021', 'D012', 'C018', 'D020', 'F006', 'B051', 'F004', 'B037', 'C015', 'F018'], '2020-05-07': ['E003'], '2020-07-05': ['F001', 'F010', 'C010', 'F002', 'D034', 'F008', 'F007', 'F009', 'F012', 'C021'], '2020-07-02': ['E005'], '2020-08-08': ['C004', 'C006', 'D022', 'F003', 'C007', 'C019', 'F001', 'D025', 'C011', 'F010', 'F015', 'E007', 'B017', 'D010', 'C010', 'C008', 'C012', 'F005', 'F013', 'D034', 'D015', 'D018', 'B058', 'C020', 'E004', 'D036', 'F016', 'F008', 'F017', 'D013', 'F007', 'F009', 'D014', 'C009', 'F012', 'F014', 'C017', 'C026', 'C028', 'D009', 'D029', 'B053a', 'D008', 'D011', 'C013', 'C003', 'C025', 'C005', 'C002', 'C027', 'C021', 'D039', 'D012', 'B053c', 'C014', 'F006', 'F004', 'C015', 'F018'], '2020-03-02': ['C004', 'D028', 'A014R', 'D022', 'C007', 'D030', 'B030', 'F001', 'C011', 'D032', 'F015', 'D026', 'E007', 'A005R', 'B018b', 'C012', 'F002', 'C023', 'D034', 'D015', 'D023', 'D018', 'E004', 'D036', 'B057', 'F008', 'B018c', 'F017', 'E002', 'B023', 'D013', 'B029', 'D004', 'A018', 'F009', 'B011', 'D014', 'F012', 'B059', 'B007', 'C017', 'C026', 'B008', 'E001', 'C028', 'B018a', 'B020', 'B061', 'E003', 'D009', 'D029', 'B053a', 'D008', 'D011', 'D003', 'C025', 'B043', 'B049', 'C022', 'D005', 'C021', 'C024', 'D039', 'D012', 'B053c', 'C014', 'B053b', 'C018', 'F006', 'B010', 'F018'], '2020-04-28': ['E007', 'E004', 'E005', 'E003'], '2020-07-30': ['D037', 'F003', 'D038', 'C007', 'A024', 'C019', 'F001', 'F010', 'D002', 'F015', 'D017', 'C010', 'F002', 'F005', 'F013', 'D006', 'C023', 'D015', 'D035', 'D036', 'F016', 'F008', 'A015R', 'E002', 'D013', 'F009', 'F012', 'F014', 'E001', 'D033', 'D008', 'D011', 'C013', 'D003', 'C022', 'C005', 'C002', 'D031', 'C021', 'C024', 'D012', 'C014', 'C018', 'A009R', 'F006', 'F018'], '2020-05-03': ['E007', 'E004', 'E002', 'E001'], '2020-07-06': ['D032', 'E007', 'C008', 'C020', 'E001', 'E005'], '2020-03-24': ['E004', 'E001'], '2020-07-07': ['F003', 'C007', 'D023', 'E005', 'F018'], '2020-07-13': ['C011', 'D024', 'E004', 'F016', 'F017', 'C002'], '2020-03-03': ['F011', 'C004', 'D028', 'C006', 'D022', 'C007', 'D030', 'B030', 'C019', 'C011', 'D032', 'F010', 'D002', 'F015', 'D026', 'E007', 'B018b', 'D010', 'B031', 'B005', 'C012', 'C023', 'D034', 'D015', 'D023', 'B032', 'D018', 'E004', 'D036', 'B057', 'F008', 'B018c', 'F017', 'E002', 'B023', 'D013', 'B029', 'D004', 'F007', 'F009', 'B011', 'C009', 'F012', 'B059', 'B007', 'C017', 'C026', 'B008', 'E001', 'C028', 'B018a', 'B027', 'B020', 'B061', 'E003', 'D009', 'B053a', 'D011', 'B009', 'C013', 'D003', 'C025', 'B043', 'B049', 'B013', 'C022', 'D005', 'C021', 'C024', 'D012', 'B053c', 'B053b', 'C018', 'F006', 'F018'], '2020-06-24': ['F003', 'F010', 'E007', 'F008', 'E002', 'F014', 'E001', 'F006', 'F004'], '2020-02-28': ['D037', 'B021', 'D028', 'D022', 'F003', 'D030', 'B030', 'C019', 'F001', 'C011', 'D032', 'F010', 'D002', 'F015', 'D026', 'E007', 'A006', 'A022', 'B018b', 'B031', 'C008', 'C012', 'F005', 'F013', 'D006', 'C023', 'D015', 'D024', 'B058', 'C020', 'E004', 'D036', 'F016', 'F008', 'B018c', 'B028', 'B014', 'B023', 'D013', 'D001', 'B029', 'D004', 'F007', 'F009', 'B025', 'B011', 'C009', 'F014', 'C017', 'C026', 'E001', 'E005', 'B018a', 'B020', 'A025', 'D033', 'E003', 'D009', 'B053a', 'D008', 'D011', 'B009', 'C003', 'D003', 'B033', 'B012', 'C025', 'B026', 'C022', 'B022', 'C005', 'D005', 'D031', 'C021', 'C024', 'D012', 'C014', 'B053b', 'C018', 'A010', 'B010', 'B051', 'F004', 'C015'], '2020-04-01': ['E007'], '2020-03-01': ['D037', 'B024', 'C004', 'D028', 'D022', 'D038', 'C007', 'B030', 'F001', 'C011', 'F015', 'D026', 'E007', 'A023', 'B018b', 'B017', 'C010', 'C012', 'F002', 'D006', 'C023', 'D034', 'D015', 'D024', 'D023', 'C020', 'D035', 'E004', 'D036', 'D021', 'B018c', 'B028', 'B050R', 'E002', 'B023', 'D013', 'B029', 'D004', 'A018', 'B011', 'B059', 'B007', 'B034', 'C017', 'C026', 'B008', 'E001', 'C028', 'B018a', 'B020', 'B061', 'D033', 'E003', 'D009', 'B053a', 'D008', 'D011', 'B009', 'D003', 'C025', 'B043', 'B049', 'C022', 'C005', 'D005', 'B015', 'C027', 'C021', 'C024', 'D039', 'D012', 'B053c', 'C014', 'B053b', 'C018', 'A009R', 'D020', 'B047', 'F006', 'B010', 'F004'], '2020-03-13': ['D028', 'D038', 'D030', 'C019', 'B038', 'C012', 'F005', 'D006', 'D034', 'D015', 'D023', 'D018', 'D013', 'D004', 'E001', 'B027', 'B033', 'B045', 'C002'], '2020-06-25': ['C019', 'C012', 'E001', 'E003'], '2020-07-19': ['F011', 'F003', 'C007', 'D030', 'F001', 'D025', 'D026', 'C012', 'F002', 'F013', 'D034', 'D015', 'F008', 'F017', 'B011', 'D014', 'F014', 'B053a', 'D005', 'A010', 'F006', 'F004', 'F018'], '2020-08-01': ['F011', 'A024', 'F001', 'C011', 'F010', 'D002', 'F015', 'D010', 'C008', 'C012', 'F002', 'F005', 'F013', 'D006', 'C023', 'C020', 'F016', 'F008', 'A015R', 'F017', 'D004', 'F007', 'F009', 'D014', 'F012', 'F014', 'D009', 'D003', 'D031', 'C021', 'C014', 'A009R', 'F006', 'F004', 'F018'], '2020-04-14': ['E007', 'E003'], '2020-03-16': ['E007', 'E004'], '2020-04-29': ['E007', 'F017', 'E001', 'E005'], '2020-03-17': ['E004'], '2020-03-12': ['F011', 'A005R', 'C008', 'F008', 'E005', 'B020', 'D009'], '2020-04-07': ['E003'], '2020-07-27': ['F011', 'C004', 'C019', 'F010', 'D002', 'F015', 'E007', 'C010', 'C008', 'C012', 'F005', 'F013', 'C023', 'D015', 'D018', 'C020', 'E004', 'F016', 'F008', 'F017', 'E002', 'F009', 'C009', 'F014', 'C028', 'D033', 'D008', 'D011', 'C013', 'D005', 'C027', 'C021', 'C024', 'C014', 'C018', 'A009R', 'F006', 'F018'], '2020-03-30': ['E001'], '2020-07-15': ['C006', 'F003', 'F001', 'C011', 'D032', 'F015', 'D017', 'C008', 'F002', 'F005', 'F013', 'D006', 'F008', 'E002', 'D013', 'D004', 'F007', 'F009', 'D014', 'C009', 'F014', 'C026', 'D009', 'C003', 'C022', 'C005', 'D005', 'F006', 'F004'], '2020-06-28': ['B039', 'C019', 'F010', 'D002', 'F014', 'E001', 'B053c'], '2020-03-15': ['E007', 'E004', 'E002', 'E001'], '2020-07-01': ['D015', 'C020', 'F007', 'B033', 'C022'], '2020-05-31': ['E001', 'E005', 'E003'], '2020-03-26': ['E004'], '2020-07-29': ['C004', 'C006', 'D022', 'F003', 'C007', 'C019', 'F010', 'D002', 'F015', 'D017', 'D019', 'C010', 'C008', 'C012', 'F002', 'F005', 'F013', 'C023', 'D015', 'D018', 'D027', 'C020', 'E004', 'D036', 'F016', 'F008', 'A015R', 'E002', 'F009', 'C009', 'F014', 'C017', 'D011', 'C013', 'C022', 'C005', 'D005', 'C027', 'C021', 'C024', 'D012', 'F006', 'F018'], '2020-05-08': ['E004', 'E001', 'E003'], '2020-07-28': ['F011', 'F003', 'D038', 'C019', 'F010', 'D002', 'F015', 'E007', 'C012', 'F002', 'F005', 'F013', 'C023', 'D015', 'D018', 'C020', 'E004', 'F016', 'F008', 'A015R', 'F017', 'E002', 'F007', 'F009', 'C009', 'F014', 'C026', 'C028', 'D011', 'C013', 'D005', 'C021', 'C024', 'D012', 'C014', 'F006', 'F004', 'F018'], '2020-07-31': ['F011', 'F003', 'C007', 'A024', 'F001', 'F010', 'D002', 'F015', 'D017', 'F002', 'F005', 'F013', 'D006', 'C023', 'D034', 'D027', 'D036', 'F016', 'F008', 'A015R', 'D013', 'D004', 'F007', 'F009', 'D014', 'F012', 'F014', 'C028', 'E003', 'D029', 'C013', 'D003', 'C022', 'C002', 'D031', 'C021', 'C024', 'A009R', 'F006', 'F004', 'F018'], '2020-06-30': ['E004', 'E003', 'B009'], '2020-08-03': ['D037', 'F011', 'C006', 'D022', 'F003', 'C019', 'F001', 'C011', 'F010', 'D002', 'F015', 'D026', 'E007', 'D017', 'D010', 'C008', 'C012', 'F002', 'F005', 'F013', 'D006', 'C023', 'D034', 'D018', 'D035', 'D036', 'F016', 'F008', 'F017', 'D004', 'F007', 'F009', 'D014', 'F012', 'F014', 'C017', 'C026', 'E005', 'D009', 'C013', 'D003', 'C025', 'D005', 'C027', 'C024', 'D039', 'D012', 'F006', 'F004', 'C015', 'F018'], '2020-07-21': ['F011', 'D030', 'D032', 'D002', 'F015', 'C012', 'D006', 'D015', 'D023', 'D018', 'F017', 'D004', 'B011', 'F014', 'C028', 'C013', 'D003', 'C025', 'C002', 'C024', 'C014', 'F018'], '2020-03-31': ['E004', 'E005'], '2020-08-10': ['D037', 'B024', 'D028', 'F003', 'D038', 'D030', 'C019', 'F001', 'C011', 'D032', 'F010', 'D002', 'F015', 'D026', 'E007', 'D017', 'B017', 'D010', 'B003', 'F005', 'F013', 'D006', 'C023', 'D034', 'D015', 'D023', 'D018', 'C020', 'E004', 'D036', 'B057', 'F016', 'F008', 'B028', 'F017', 'E002', 'D013', 'D001', 'B029', 'D014', 'F012', 'F014', 'B007', 'C017', 'C026', 'E001', 'E003', 'D009', 'D029', 'D008', 'D011', 'C013', 'D003', 'C025', 'C022', 'D005', 'D031', 'C021', 'D039', 'D012', 'C014', 'C018', 'F006', 'F004', 'C015', 'F018'], '2020-06-26': ['D026'], '2020-04-30': ['D028', 'F003', 'E007', 'C020', 'F008', 'D013', 'E001', 'D008', 'C013'], '2020-03-22': ['E007', 'E002', 'E001'], '2020-05-22': ['E004'], '2020-07-08': ['C004', 'C006', 'D022', 'F015', 'D017', 'D010', 'C010', 'F002', 'F013', 'D006', 'C023', 'D034', 'D018', 'D035', 'F016', 'F017', 'E002', 'D013', 'D004', 'F007', 'F014', 'D033', 'D009', 'D011', 'C003', 'C022', 'F018'], '2020-03-07': ['F017', 'F007'], '2020-07-22': ['F011', 'F015', 'E007', 'C008', 'C012', 'D023', 'D018', 'D027', 'B057', 'F017', 'B050R', 'D013', 'E001', 'E005', 'C028', 'E003', 'C013', 'C003', 'C002', 'A013R', 'C014', 'A010', 'F018'], '2020-06-18': ['D023'], '2020-05-29': ['E003'], '2020-07-17': ['F016', 'E003'], '2020-03-09': ['E007', 'B018b', 'B031', 'E004', 'E002', 'E001', 'E005', 'E003'], '2020-04-27': ['E007', 'E004', 'E003'], '2020-08-09': ['D037', 'B024', 'B039', 'B036', 'B021', 'F003', 'D038', 'A024', 'B030', 'C019', 'F001', 'C011', 'F010', 'B038', 'D002', 'F015', 'D026', 'E007', 'A005R', 'B019', 'A006', 'B017', 'D010', 'C008', 'C012', 'F005', 'F013', 'D006', 'D015', 'D023', 'B032', 'D018', 'C020', 'E004', 'D036', 'B004', 'B057', 'F016', 'F008', 'F017', 'E002', 'D001', 'D004', 'B025', 'B011', 'D014', 'F012', 'F014', 'B059', 'B007', 'C017', 'C026', 'E001', 'B018a', 'B041', 'A025', 'D009', 'D029', 'B053a', 'D008', 'C013', 'C025', 'B043', 'B022', 'D005', 'C027', 'C021', 'D039', 'D012', 'B053c', 'C014', 'C018', 'F006', 'F004', 'C015', 'F018'], '2020-07-18': ['D032', 'D023', 'F006', 'F018'], '2020-05-06': ['B029', 'E003'], '2020-08-13': ['D037', 'F011', 'B021', 'D028', 'F003', 'D038', 'D030', 'C019', 'F001', 'C011', 'F010', 'D002', 'F015', 'D026', 'D010', 'C008', 'C012', 'F005', 'F013', 'D006', 'C023', 'D015', 'B032', 'D027', 'C020', 'D035', 'E004', 'B057', 'F016', 'F008', 'F017', 'E002', 'D013', 'D001', 'D004', 'F007', 'F009', 'D014', 'C009', 'F012', 'F014', 'B007', 'B034', 'C017', 'C026', 'B008', 'E001', 'C028', 'A025', 'E003', 'D009', 'D029', 'D008', 'D011', 'B009', 'C013', 'D003', 'B012', 'C025', 'D005', 'B015', 'D031', 'C027', 'C021', 'C024', 'D012', 'B053c', 'C018', 'D020', 'F006', 'B051', 'F004', 'C015'], '2020-07-14': ['C006', 'C019', 'C011', 'D032', 'C008', 'F013', 'D015', 'D035', 'F017', 'C009', 'F014', 'C017', 'B006', 'D033', 'D009', 'D011', 'C003', 'C022', 'D005', 'F018'], '2020-07-12': ['C019', 'C010', 'D006', 'C023', 'D034', 'E004', 'F016', 'F009', 'D014', 'C028', 'C013', 'D031', 'C014', 'C015'], '2020-04-18': ['E007'], '2020-06-16': ['E004'], '2020-03-11': ['B039', 'B004', 'B009', 'B010'], '2020-03-20': ['E004'], '2020-06-02': ['E007'], '2020-08-05': ['D037', 'B039', 'F011', 'A007R', 'D022', 'F003', 'A024', 'B030', 'C019', 'F001', 'F010', 'D002', 'F015', 'D026', 'E007', 'D017', 'C012', 'F002', 'F005', 'F013', 'C023', 'D034', 'D018', 'C020', 'D036', 'F016', 'F008', 'F017', 'E002', 'D013', 'D004', 'F007', 'F009', 'D014', 'C009', 'F012', 'F014', 'C017', 'C026', 'B020', 'E003', 'D009', 'D011', 'C013', 'D003', 'C022', 'C005', 'D005', 'C027', 'C024', 'D039', 'D012', 'F006', 'F004', 'F018'], '2020-05-14': ['A024'], '2020-07-16': ['D037', 'D028', 'F003', 'C012', 'F002', 'F013', 'C023', 'D034', 'D015', 'D024', 'D036', 'F008', 'D001', 'F009', 'F006', 'F018'], '2020-07-09': ['D037', 'C004', 'D002', 'D017', 'D010', 'C008', 'C012', 'D034', 'D036', 'C017', 'D033', 'D009', 'D029', 'D039'], '2020-04-20': ['E007', 'E004', 'E001', 'E003'], '2020-08-11': ['D037', 'F011', 'C004', 'D028', 'F003', 'D038', 'D030', 'F001', 'D032', 'F010', 'D002', 'F015', 'D026', 'E007', 'D010', 'C008', 'C012', 'F005', 'F013', 'D006', 'C023', 'D034', 'D015', 'D018', 'C020', 'D036', 'F016', 'F008', 'F017', 'B001', 'E002', 'D013', 'F007', 'F009', 'D014', 'F014', 'C017', 'E001', 'E005', 'C028', 'D033', 'E003', 'D009', 'D029', 'D008', 'D011', 'C013', 'D003', 'A021', 'D005', 'C002', 'D031', 'C021', 'D039', 'C014', 'C018', 'F006', 'F004', 'C015', 'F018'], '2020-04-21': ['E007', 'E005', 'E003'], '2020-08-07': ['B036', 'F011', 'C004', 'D022', 'F003', 'D038', 'C019', 'C011', 'F010', 'F015', 'D017', 'D010', 'C010', 'F005', 'F013', 'D034', 'D015', 'B002', 'D018', 'C020', 'D036', 'F016', 'F008', 'B028', 'F017', 'B014', 'D013', 'F007', 'F009', 'D014', 'F012', 'F014', 'B034', 'C026', 'C028', 'B027', 'D009', 'D008', 'D011', 'C003', 'C005', 'C002', 'A002', 'D031', 'C021', 'A004', 'C024', 'D039', 'D012', 'C014', 'F006', 'F004', 'F018'], '2020-02-29': ['B021', 'D028', 'C006', 'D022', 'D038', 'F001', 'F015', 'D026', 'E007', 'B018b', 'B031', 'C012', 'F005', 'F013', 'D006', 'C023', 'C020', 'D035', 'E004', 'D036', 'F016', 'F008', 'B018c', 'B028', 'B014', 'B023', 'B029', 'D004', 'F007', 'B025', 'B011', 'D014', 'F014', 'C017', 'E001', 'B018a', 'A025', 'D033', 'E003', 'D009', 'B053a', 'D008', 'D011', 'B009', 'D003', 'B012', 'B045', 'C022', 'C021', 'C024', 'D012', 'C014', 'B053b', 'C018', 'B010'], '2020-03-05': ['B024', 'F011', 'C004', 'D028', 'C006', 'D038', 'C007', 'D030', 'A024', 'C019', 'D025', 'C011', 'D032', 'F010', 'B038', 'D002', 'F015', 'E007', 'A005R', 'D017', 'D019', 'B018b', 'D010', 'B052R', 'B031', 'B005', 'C012', 'D034', 'D015', 'D024', 'D023', 'D018', 'E004', 'D036', 'B057', 'F008', 'B028', 'A015R', 'F017', 'E002', 'D013', 'B029', 'D004', 'F007', 'F009', 'B011', 'B007', 'B048R', 'B008', 'E001', 'E005', 'C028', 'E003', 'D009', 'D029', 'B053a', 'D011', 'B009', 'C013', 'D003', 'C025', 'B013', 'B045', 'B026', 'D005', 'C002', 'C027', 'C021', 'A004', 'D039', 'C014', 'B053b', 'C018', 'B037', 'C015', 'F018'], '2020-03-14': ['E001'], '2020-08-04': ['D037', 'B036', 'F011', 'C006', 'D022', 'F003', 'C019', 'F001', 'C011', 'F010', 'D002', 'F015', 'D026', 'E007', 'D017', 'C012', 'F002', 'F005', 'F013', 'C023', 'D034', 'D023', 'B032', 'D018', 'D036', 'F016', 'F008', 'F017', 'E002', 'D004', 'F007', 'F009', 'D014', 'F012', 'F014', 'C017', 'C026', 'C028', 'E003', 'D009', 'D011', 'C013', 'D003', 'C022', 'C005', 'D005', 'A002', 'C027', 'C024', 'D039', 'D012', 'B053c', 'F006', 'F004', 'C015', 'F018'], '2020-07-20': ['F011', 'C004', 'D028', 'F003', 'C007', 'D030', 'F001', 'C011', 'D002', 'C008', 'C012', 'F002', 'F013', 'D034', 'D015', 'D036', 'F008', 'F017', 'F007', 'B011', 'D014', 'C009', 'F014', 'C017', 'C026', 'C028', 'C013', 'D003', 'C025', 'C002', 'D012', 'C014', 'F006', 'F018'], '2020-07-23': ['C019', 'F015', 'D010', 'F017', 'E001', 'C028', 'E003', 'C013', 'C003', 'C022', 'C005', 'D005', 'D039', 'F004'], '2020-04-26': ['E007', 'E001'], '2020-07-25': ['F011', 'F003', 'C007', 'F001', 'F010', 'D002', 'F015', 'D006', 'D034', 'D027', 'F016', 'F008', 'D013', 'F007', 'F009', 'F014', 'C026', 'D009', 'D003', 'C025', 'D005', 'F006'], '2020-05-05': ['B029', 'E003'], '2020-03-25': ['E004', 'E001'], '2020-07-24': ['F011', 'C004', 'F015', 'D034', 'C020', 'F016', 'D014', 'F014', 'C026', 'E001', 'D029', 'D003', 'C022', 'D031', 'C024', 'D012', 'C018', 'F004'], '2020-06-09': ['E004'], '2020-03-29': ['E007', 'F012', 'E001'], '2020-04-02': ['E007'], '2020-03-06': ['F011', 'C006', 'D022', 'C019', 'C011', 'F010', 'F015', 'E007', 'D019', 'C010', 'C012', 'F013', 'D006', 'D034', 'D018', 'D027', 'E004', 'D036', 'F016', 'F008', 'B028', 'F017', 'E002', 'D013', 'D004', 'F012', 'F014', 'C017', 'E001', 'E005', 'B041', 'E003', 'D009', 'D029', 'B053a', 'C013', 'B013', 'C021', 'D039', 'D012', 'C014', 'B053b', 'C018', 'C015', 'F018'], '2020-04-05': ['E001'], '2020-07-26': ['F011', 'D022', 'D030', 'F001', 'C011', 'D032', 'F010', 'F015', 'C012', 'F013', 'C023', 'D015', 'D018', 'F016', 'F008', 'F017', 'E002', 'D013', 'F009', 'C009', 'F012', 'F014', 'D008', 'C005', 'C021', 'C014', 'A009R', 'F006'], '2020-03-21': ['E004', 'B043'], '2020-06-01': ['E004', 'E001', 'E003'], '2020-08-14': ['D037', 'F011', 'D028', 'F003', 'D030', 'F001', 'F010', 'B038', 'D002', 'F015', 'D026', 'A006', 'A027', 'A022', 'B017', 'D010', 'B003', 'C008', 'C012', 'F005', 'F013', 'D006', 'C023', 'A019', 'D015', 'B035', 'D027', 'C020', 'D035', 'E004', 'F016', 'F008', 'F017', 'B014', 'B001', 'E002', 'D013', 'D001', 'D004', 'F007', 'F009', 'B011', 'D014', 'C009', 'F012', 'F014', 'C017', 'C026', 'A028', 'C028', 'B018a', 'D033', 'D009', 'D029', 'D008', 'D011', 'C013', 'D003', 'C025', 'D005', 'B015', 'A002', 'D031', 'C027', 'C021', 'D012', 'B053c', 'F006', 'F004', 'C015'], '2020-04-23': ['E002', 'E003'], '2020-08-06': ['D037', 'F011', 'C004', 'D022', 'F003', 'D038', 'F010', 'D002', 'F015', 'D026', 'D017', 'F002', 'F005', 'F013', 'D034', 'D015', 'D018', 'D027', 'D036', 'F016', 'F008', 'F017', 'E002', 'D013', 'D004', 'F007', 'F009', 'D014', 'F012', 'F014', 'C026', 'E003', 'D009', 'D008', 'D011', 'C005', 'D005', 'C027', 'D039', 'D012', 'F006', 'F004', 'F018'], '2020-03-10': ['D022', 'D038', 'D030', 'D017', 'D015', 'D018', 'B058', 'F008', 'D001', 'F007', 'C017', 'E001', 'E003', 'D008', 'B053c', 'B053b', 'B054R']}
for key, sites in new_data.items():
    for site in sites:
        if site not in all_sites:
            all_sites[site] = count
            count += 1
all_sites_reverse = {x:i for i, x in all_sites.items()}

for key, sites in new_data.items():
    date = key.split('-')
    day, month = date[2], date[1]
    months_avail[month].update({key:sites})

for month, month_dict in months_avail.items():
    month_wise_dict = defaultdict(list)
    for date, sites in month_dict.items():
        day = date.split('-')[2]
        for site in sites:
            if site in all_sites:
                month_wise_dict[day].append(all_sites[site])
    months_mapped_dict[month].update(month_wise_dict)

date = 15
days = 2
for month, dic in months_mapped_dict.items():
    sites_matrix = createMatrix(dic, len(all_sites))
    avalaible_sites = findDates(sites_matrix, date, days)
    print('Month', month)
    if avalaible_sites:
        for site in avalaible_sites:
            print(all_sites_reverse[site])
